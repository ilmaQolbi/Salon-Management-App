<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.URL?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<StackPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="Controller.KaryawanController">
    <children>
        <BorderPane style="-fx-background-color: #fdfbf7;">

            <stylesheets>
                <URL value="@../Style/karyawan.css" />
            </stylesheets>

            <!-- SIDEBAR KIRI -->
            <left>
                <VBox prefWidth="220.0" style="-fx-background-color: #3e2723;" BorderPane.alignment="CENTER">
                    <children>
                        <!-- HEADER SIDEBAR -->
                        <VBox alignment="CENTER" prefHeight="100.0" style="-fx-background-color: linear-gradient(to bottom, #5d4037, #3e2723);">
                            <children>
                                <Label text="STYLIST" textFill="WHITE">
                                    <font>
                                        <Font name="System Bold" size="24.0" />
                                    </font>
                                </Label>
                                <Label text="WORKSPACE" textFill="#d7ccc8">
                                    <font>
                                        <Font size="12.0" />
                                    </font>
                                </Label>
                                <Label fx:id="lblNamaUser" text="Halo, Stylist" textFill="#d7ccc8">
                                    <VBox.margin>
                                        <Insets top="10.0" />
                                    </VBox.margin>
                                    <font>
                                        <Font size="13.0" />
                                    </font>
                                </Label>
                            </children>
                        </VBox>

                        <!-- MENU BUTTONS -->
                        <VBox spacing="5.0">
                            <padding>
                                <Insets bottom="10.0" left="10.0" right="10.0" top="15.0" />
                            </padding>
                            <children>
                                <Button fx:id="btnAntrian" mnemonicParsing="false" onAction="#handleShowAntrian" prefWidth="200.0" styleClass="sidebar-button" text="ðŸ“‹ Antrian Pekerjaan" />
                                <Button fx:id="btnRiwayat" mnemonicParsing="false" onAction="#handleShowRiwayat" prefWidth="200.0" styleClass="sidebar-button" text="ðŸ“œ Riwayat Transaksi" />
                                <Button fx:id="btnKomisi" mnemonicParsing="false" onAction="#handleShowKomisi" prefWidth="200.0" styleClass="sidebar-button" text="ðŸ’° Lihat Komisi" />
                            </children>
                        </VBox>

                        <!-- SPACER + LOGOUT -->
                        <VBox alignment="BOTTOM_CENTER" VBox.vgrow="ALWAYS">
                            <padding>
                                <Insets bottom="20.0" left="10.0" right="10.0" />
                            </padding>
                            <children>
                                <Button mnemonicParsing="false" onAction="#handleLogout" prefWidth="200.0" styleClass="btn-danger" text="Logout" />
                            </children>
                        </VBox>
                    </children>
                </VBox>
            </left>

            <!-- CONTENT AREA -->
            <center>
                <StackPane fx:id="contentArea" BorderPane.alignment="CENTER">
                    <children>
                        <!-- VIEW: ANTRIAN PEKERJAAN (DEFAULT) -->
                        <VBox fx:id="viewAntrian" spacing="20.0" visible="true">
                            <padding>
                                <Insets bottom="25.0" left="25.0" right="25.0" top="25.0" />
                            </padding>
                            <children>
                                <Label styleClass="label-header" text="Antrian Pekerjaan Hari Ini" />

                                <!-- STATS CARDS -->
                                <HBox spacing="20.0">
                                    <children>
                                        <VBox prefWidth="200.0" styleClass="card-pane" style="-fx-background-color: linear-gradient(to right, #8d6e63, #a1887f);">
                                            <children>
                                                <Label text="Menunggu" textFill="WHITE">
                                                    <font><Font name="System Bold" size="14.0" /></font>
                                                </Label>
                                                <Label fx:id="lblPending" text="0" textFill="WHITE">
                                                    <font><Font name="System Bold" size="36.0" /></font>
                                                </Label>
                                                <Label text="Pekerjaan belum selesai" textFill="#ffffffcc">
                                                    <font><Font size="11.0" /></font>
                                                </Label>
                                            </children>
                                        </VBox>

                                        <VBox prefWidth="200.0" styleClass="card-pane" style="-fx-background-color: linear-gradient(to right, #6d4c41, #8d6e63);">
                                            <children>
                                                <Label text="Selesai Hari Ini" textFill="WHITE">
                                                    <font><Font name="System Bold" size="14.0" /></font>
                                                </Label>
                                                <Label fx:id="lblSelesai" text="0" textFill="WHITE">
                                                    <font><Font name="System Bold" size="36.0" /></font>
                                                </Label>
                                                <Label text="Layanan tuntas" textFill="#ffffffcc">
                                                    <font><Font size="11.0" /></font>
                                                </Label>
                                            </children>
                                        </VBox>

                                        <VBox prefWidth="200.0" styleClass="card-pane" style="-fx-background-color: linear-gradient(to right, #5d4037, #795548);">
                                            <children>
                                                <Label text="Komisi Hari Ini" textFill="WHITE">
                                                    <font><Font name="System Bold" size="14.0" /></font>
                                                </Label>
                                                <Label fx:id="lblKomisiHariIni" text="Rp 0" textFill="WHITE">
                                                    <font><Font name="System Bold" size="24.0" /></font>
                                                </Label>
                                                <Label text="Berdasarkan pekerjaan selesai" textFill="#ffffffcc">
                                                    <font><Font size="11.0" /></font>
                                                </Label>
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>

                                <!-- TABLE ANTRIAN -->
                                <VBox styleClass="card-pane" VBox.vgrow="ALWAYS">
                                    <children>
                                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                                            <children>
                                                <Label styleClass="label-subheader" text="Daftar Antrian Pelanggan" />
                                                <Button mnemonicParsing="false" onAction="#handleRefresh" style="-fx-background-color: #795548; -fx-text-fill: white;" text="ðŸ”„ Refresh" />
                                            </children>
                                            <VBox.margin>
                                                <Insets bottom="10.0" />
                                            </VBox.margin>
                                        </HBox>

                                        <TableView fx:id="tablePekerjaan" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="colIdTransaksi" prefWidth="80.0" text="ID Order" />
                                                <TableColumn fx:id="colPelanggan" prefWidth="180.0" text="Pelanggan" />
                                                <TableColumn fx:id="colLayanan" prefWidth="200.0" text="Layanan" />
                                                <TableColumn fx:id="colWaktu" prefWidth="130.0" text="Waktu Masuk" />
                                                <TableColumn fx:id="colStatus" prefWidth="100.0" style="-fx-alignment: CENTER;" text="Status" />
                                                <TableColumn fx:id="colAction" prefWidth="130.0" style="-fx-alignment: CENTER;" text="Aksi" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- VIEW: RIWAYAT TRANSAKSI -->
                        <VBox fx:id="viewRiwayat" spacing="20.0" visible="false">
                            <padding>
                                <Insets bottom="25.0" left="25.0" right="25.0" top="25.0" />
                            </padding>
                            <children>
                                <Label styleClass="label-header" text="Riwayat Transaksi" />
                                <VBox styleClass="card-pane" VBox.vgrow="ALWAYS">
                                    <children>
                                        <TableView fx:id="tableRiwayat" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="colRiwayatId" prefWidth="80.0" text="ID" />
                                                <TableColumn fx:id="colRiwayatPelanggan" prefWidth="180.0" text="Pelanggan" />
                                                <TableColumn fx:id="colRiwayatLayanan" prefWidth="200.0" text="Layanan" />
                                                <TableColumn fx:id="colRiwayatTanggal" prefWidth="150.0" text="Tanggal" />
                                                <TableColumn fx:id="colRiwayatStatus" prefWidth="100.0" text="Status" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- VIEW: KOMISI -->
                        <VBox fx:id="viewKomisi" spacing="20.0" visible="false">
                            <padding>
                                <Insets bottom="25.0" left="25.0" right="25.0" top="25.0" />
                            </padding>
                            <children>
                                <Label styleClass="label-header" text="Laporan Komisi" />
                                
                                <!-- KOMISI SUMMARY -->
                                <HBox spacing="20.0">
                                    <children>
                                        <VBox prefWidth="250.0" styleClass="card-pane" style="-fx-background-color: linear-gradient(to right, #4e342e, #6d4c41);">
                                            <children>
                                                <Label text="Total Komisi Bulan Ini" textFill="WHITE">
                                                    <font><Font name="System Bold" size="14.0" /></font>
                                                </Label>
                                                <Label fx:id="lblTotalKomisi" text="Rp 0" textFill="WHITE">
                                                    <font><Font name="System Bold" size="32.0" /></font>
                                                </Label>
                                            </children>
                                        </VBox>
                                        <VBox prefWidth="200.0" styleClass="card-pane" style="-fx-background-color: linear-gradient(to right, #3e2723, #5d4037);">
                                            <children>
                                                <Label text="Total Pekerjaan" textFill="WHITE">
                                                    <font><Font name="System Bold" size="14.0" /></font>
                                                </Label>
                                                <Label fx:id="lblTotalPekerjaan" text="0" textFill="WHITE">
                                                    <font><Font name="System Bold" size="32.0" /></font>
                                                </Label>
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>

                                <VBox styleClass="card-pane" VBox.vgrow="ALWAYS">
                                    <children>
                                        <Label styleClass="label-subheader" text="Rincian Komisi per Layanan" />
                                        <TableView fx:id="tableKomisi" VBox.vgrow="ALWAYS">
                                            <columns>
                                                <TableColumn fx:id="colKomisiLayanan" prefWidth="250.0" text="Layanan" />
                                                <TableColumn fx:id="colKomisiJumlah" prefWidth="100.0" text="Jumlah" />
                                                <TableColumn fx:id="colKomisiNilai" prefWidth="150.0" text="Komisi" />
                                            </columns>
                                            <columnResizePolicy>
                                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                            </columnResizePolicy>
                                        </TableView>
                                    </children>
                                </VBox>
                            </children>
                        </VBox>
                    </children>
                </StackPane>
            </center>
        </BorderPane>

        <!-- FAB LAPORKAN KENDALA -->
        <Button mnemonicParsing="false" onAction="#handleLaporKendala" styleClass="fab-btn" text="âš  Laporkan Kendala" StackPane.alignment="BOTTOM_LEFT">
            <StackPane.margin>
                <Insets bottom="20.0" left="240.0" />
            </StackPane.margin>
        </Button>
    </children>
</StackPane>